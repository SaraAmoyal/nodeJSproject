const express=require('express');
const app=express();
const router=express.Router();
const fs=require('fs');
const MongoClient = require('mongodb').MongoClient;
const url = 'mongodb://localhost:27017';
const dbName = 'endProject';

app.listen(3000, function () {
    console.log('Example app listening on port 3000!');
  });

app.use(function(req, res, next){
    
    
    res.header("Access-Control-Allow-Origin", "*"); // update to match the domain you will make the request from
    res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
    req.header("Access-Control-Allow-Origin", "*"); // update to match the domain you will make the request from
    req.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
//    Console.log("workersFunctions used.");
    next();
});

router.post('/deleteWorker/:id', function(req ,res){
    console.log("arived delete worker, try connect");
    MongoClient.connect(url, function(err, client) {

    if (err) console.log("can't connect!");
    else{
     const myDataBase = client.db(dbName);
     const workersCollection=myDataBase.collection('workers');
     
workersCollection.update(
    {id:req.id},
     {$set:{
            "isAction":false
}})

     client.close();
     console.log("succeed connect.");
    }

});
});


module.exports=router;
